<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tomás’ Art Gallery</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 1000px; margin: auto; padding: 20px; }
    h1 { text-align: center; }
    #search { width: 100%; padding: 10px; margin-bottom: 20px; font-size: 16px; }
    #gallery { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; }
    .painting img { width: 100%; height: auto; border-radius: 5px; cursor: pointer; }
    .painting { text-align: center; font-size: 14px; }
    #adminLink { display: block; text-align: center; margin: 20px 0; font-weight: bold; }
  </style>
</head>
<body>

<h1>Tomás’ Art Gallery</h1>
<input type="text" id="search" placeholder="Search by title, description, or date">

<div id="gallery"></div>

<a id="adminLink" href="/admin.html">Admin Login</a>

<script>
async function loadPaintings() {
  const res = await fetch("/paintings");
  const data = await res.json();
  return data;
}

function displayPaintings(paintings) {
  const gallery = document.getElementById("gallery");
  gallery.innerHTML = "";

  paintings.forEach(p => {
    const div = document.createElement("div");
    div.className = "painting";
    div.innerHTML = `
      <img src="${p.image_filename}" alt="${p.title}">
      <strong>${p.title}</strong><br>
      ${p.date} - ${p.category || ""}
    `;
    gallery.appendChild(div);
  });
}

// Search functionality
document.getElementById("search").addEventListener("input", async (e) => {
  const allPaintings = await loadPaintings();
  const q = e.target.value.toLowerCase();
  const filtered = allPaintings.filter(p =>
    p.title.toLowerCase().includes(q) ||
    (p.description && p.description.toLowerCase().includes(q)) ||
    (p.date && p.date.toLowerCase().includes(q))
  );
  displayPaintings(filtered);
});

// Initial load
loadPaintings().then(displayPaintings);
</script>

</body>
</html>
